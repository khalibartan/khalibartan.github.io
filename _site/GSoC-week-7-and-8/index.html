<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Google Summer of Code week 7 and 8 â€“ Utkarsh's Blog</title> <meta name="description" content="My personal blog"> <meta name="keywords" content="pgmpy, GSoC"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://127.0.0.1:4000/img/avatar.jpg"> <meta name="twitter:title" content="Google Summer of Code week 7 and 8"> <meta name="twitter:description" content="MY PR for No-U-Turn-Sampler (NUTS) and NUTS with dual averaging has been merged. Apart from that I made a slight change in API of all the continuous sampling algorithms. Earlier I made the grad_log_pdf argument to be optional. Also since PR which dealt with implementing JointGaussianDistribution has been merged, I also made changes to accommodate it."> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Google Summer of Code week 7 and 8"> <meta property="og:description" content="MY PR for No-U-Turn-Sampler (NUTS) and NUTS with dual averaging has been merged. Apart from that I made a slight change in API of all the continuous sampling algorithms. Earlier I made the grad_log_pdf argument to be optional. Also since PR which dealt with implementing JointGaussianDistribution has been merged, I also made changes to accommodate it."> <meta property="og:url" content="http://127.0.0.1:4000/GSoC-week-7-and-8/"> <meta property="og:site_name" content="Utkarsh's Blog"> <meta property="og:image" content="http://127.0.0.1:4000/img/avatar.jpg"> <link rel="canonical" href="http://127.0.0.1:4000/GSoC-week-7-and-8/"> <link href="http://127.0.0.1:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Utkarsh's Blog Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://127.0.0.1:4000/assets/css/main.css"> <!-- JS --> <script src="http://127.0.0.1:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://127.0.0.1:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://127.0.0.1:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://127.0.0.1:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://127.0.0.1:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://127.0.0.1:4000/favicon.png"> <link rel="shortcut icon" href="http://127.0.0.1:4000/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://127.0.0.1:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://127.0.0.1:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://127.0.0.1:4000/img/avatar.jpg" alt="Utkarsh's Blog photo" class="author-photo"> <h4>Utkarsh's Blog</h4> <p>My personal blog</p> </li> <li><a href="http://127.0.0.1:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:utkarsh.gupta550@gail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://plus.google.com/+UtkarshGupta_khalibartan" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a> </li> <li> <a href="http://linkedin.com/in/utgup" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/khalibartan" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://127.0.0.1:4000/posts/">All Posts</a></li> <li><a href="http://127.0.0.1:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://127.0.0.1:4000/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Google Summer of Code week 7 and 8</h1> <h4>22 Jul 2016</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://127.0.0.1:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>MY PR for No-U-Turn-Sampler (NUTS) and NUTS with dual averaging has been merged PR <a href="https://github.com/pgmpy/pgmpy/pull/706">#706</a>. Apart from that I made a slight change in API of all the continuous sampling algorithms. Earlier I made the <code class="highlighter-rouge">grad_log_pdf</code> argument to be optional. You can either pass in a custom implementation or otherwise it will use the gradient function in the model object. But it was a poor design choice. Not only it was making code to look ugly, it was also making things more complex with increased number if useless checks. Other issue was that if user has to implement as custom model it will not necessarily have the gradient method. It is rightly said simpler is better :). The current API is like:</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pgmpy.inference.continuous</span> <span class="kn">import</span> <span class="n">NoUTurnSamplerDA</span> <span class="k">as</span> <span class="n">NUTSda</span><span class="p">,</span> <span class="n">GradLogPDFGaussian</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pgmpy.factors</span> <span class="kn">import</span> <span class="n">JointGaussianDistribution</span> <span class="k">as</span> <span class="n">JGD</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">JGD</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">],</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sampler</span> <span class="o">=</span> <span class="n">NUTSda</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="o">=</span><span class="n">GradLogPDFGaussian</span><span class="p">,</span> <span class="n">simulate_dynamics</span><span class="o">=</span><span class="n">LeapFrog</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]),</span> <span class="n">num_adapt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples</span>
<span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span> <span class="n">NoUTurnSamplerDA</span><span class="o">.</span><span class="n">generate_sample</span> <span class="n">at</span> <span class="mh">0x7f4fed46a4c0</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sample</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">samples_array</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">11.89963386</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.06572636</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">10.3453755</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">7.5700289</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">26.56899659</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.3920684</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">29.97143077</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.0801625</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">29.97143077</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.0801625</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">33.07960829</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.90440347</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">55.28263496</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.31718524</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">55.28263496</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.31718524</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">56.63440044</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.03309364</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">63.880094</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">19.19981944</span><span class="p">]])</span>
<span class="s">"""
</span></code></pre></div> <p>Also since PR which dealt with implementing <code class="highlighter-rouge">JointGaussianDistribution</code> has been merged, I also made changes to accommodate it. As you can see in the example I have imported <code class="highlighter-rouge">JointGaussianDistribution</code> from factors instead of models :P. Now pgmpy supports continuous models and inference on these models using sampling algorithms. I donâ€™t have any plans for next week, I have began working on the content for introductory blog posts and ipython notebooks maybe by next fortnight I might finish it.</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://127.0.0.1:4000/tags/#pgmpy" title="Pages tagged pgmpy" class="tag"><span class="term">pgmpy</span></a><a href="http://127.0.0.1:4000/tags/#GSoC" title="Pages tagged GSoC" class="tag"><span class="term">GSoC</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://127.0.0.1:4000/GSoC-week-7-and-8/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=http://127.0.0.1:4000/GSoC-week-7-and-8/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://127.0.0.1:4000/GSoC-week-7-and-8/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> <script type="text/javascript"> var disqus_shortname = 'khalibartangithubio'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> </header> <!-- JS --> <script src="http://127.0.0.1:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://127.0.0.1:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://127.0.0.1:4000/assets/js/jquery.goup.min.js"></script> <script src="http://127.0.0.1:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://127.0.0.1:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://127.0.0.1:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'khalibartangithubio'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
